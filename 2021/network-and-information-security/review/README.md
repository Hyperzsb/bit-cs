# 网络与信息安全复习提纲

## 概述

1. **网络信息安全的一些经典结论：**
   - 墨菲定理：所有程序都有缺陷
   - 大程序的缺陷甚至比包含的内容还多
   - 只要不运行这个程序，是否有缺陷，也无关紧要
   - 对暴露在外的计算机，应尽可能少地运行程序，且运行的程序也应尽可能小
2. **网络安全的特点：**
   - 机密性：杜绝有用信息泄露给非授权个人或实体
   - 完整性：信息保持非修改、非破坏和非丢失
   - 可用性：可被授权实体正确访问
   - 可控性：对网络中信息传播及内容能实现有效控制
   - 不可否认性：所有参与者不可否认或者抵赖本人的真实身份
3. **信息安全行业：**
   - 政府部门：中共中央网络安全和信息化委员会办公室；工业与信息化部，信息安全协调司；中共中央直属机关，国家商用密码管理办公室；公安部，网络安全保卫局；安全部；中国人民解放军总参谋部；
     - 国家计算机网络应急技术处理协调中心（CNCERT/CC）	
     - 商用密码技术属于国家秘密。国家对商用密码产品的科研、生产、和使用实行专控管理
   - 厂商：
     - 国外厂商：思科（Cisco）、飞塔（Fortinet）、赛门铁克（Symantec）、卡巴斯基、McAfee、趋势科技
     - 国内厂商：传统的通信保密厂商：卫士通、56所；网络安全厂商:天融信、绿盟、启明、网御；病毒厂商:安天、瑞星、江民、金山、360；网络设备厂商:华为、锐捷、迈普；
     - 国家级重要厂商：北京启明星辰信息安全技术有限公司；哈尔滨安天科技股份有限公司；北京神州绿盟科技有限公司；恒安嘉新(北京)科技有限公司；沈阳东软系统集成工程有限公司；北京奇虎科技有限公司；北京天融信网络安全技术有限公司；中国电信集团系统集成有限责任公司

## 密码学

1. **基本概念：**

2. **密码学的分类：**

   - 古典密码：

     密码体制的安全性依赖于算法本身的保密性

     不适合大规模生产；不适合较大的或者人员变动频繁的组织；用户无法了解算法的安全性

     - 代码加密：“代码”指专有词汇或者特殊用语，黑话
     - 替换加密：凯撒密码
     - 变位加密：对明文字母作重新排序
     - 一次性加密：密码本

   - 现代密码：

     把算法和密钥分开；密码算法可以公开，密钥保密；密码系统的安全性依赖于密钥的保密性

     密码算法可以经过充分论证，安全性有保证；对密码系统的管理简单；可应用于大规模场景

     现代密码的主要威胁：

     - 暴力破解的速度
     - 量子计算的发展

   - 对称密码：

     优点：

     - 加密速度快，使用简单

     缺点：

     - 密钥分配：必须通过保密通道进行
     - 密钥个数：$n$ 个用户需要 $n(n-1)$ 个密钥

   - 非对称密码：

     优点：

     - 密钥分配：不必保持信道的保密性
     - 密钥个数：$n$ 个用户需要 $n$ 个密钥

     缺点：

     - 算法速度：比对称密码算法慢10倍左右

   - 混合加密体系：

     - 结合对称密钥密码和非对称密钥密码体系
     - 采用对称方法进行通信，采用PKI体系进行密钥交换

   - 分组密码和流密码：

     根据每次操作的数据单元是否分块来区分

     - 分组密码：一次加密或解密操作作用于一个数据块，比如64bit；数据块之间加密是独立的
     - 序列密码：一次加密或解密操作作用于一位或者一个字节；前部分密文参与后部分明文的加密，数据块之间加密不独立

   - 双向加密和单向加密：

     根据明文加密后是否需要还原来区分：

     - 双向加密：明文加密后，需要解密，目的是信息的交换
     - 单向加密：明文加密后，不需要解密，目的验证数据的完整性

3. **密码分析：**

   未知密钥，利用数学方法恢复明文，或者推导出密钥

   - 暴力破解
   - 已知明文攻击
   - 选择明文攻击
   - 选择密文攻击
   - 选择密钥攻击

   其它密码攻击方法：

   - 可以针对人机系统的弱点进行攻击，而不是攻击密码算法本身
   - 欺骗用户密码（技术手段或者社会工程学）
   - 在用户输入密钥时，窥视或者偷窃密钥内容
   - 利用密码系统实现中的缺陷或者漏洞
   - 妨碍用户正确使用密码系统
   - 让口令的另一方透露密钥和信息
   - 威胁用户交出密钥

   密码算法的安全性：

   - 如果破解算法的代价大于被加密数据本身的价值，或者在信息的生命周期内无法破解，那么算法可能是安全的
   - 如果一个密码算法用可得到的资源不能被破解，则称该算法是计算上安全的

4. **对称密码算法：**

   - DES 算法：

     DES算法是一个分组加密算法，以64bit为一个分组

     DES算法使用标准的算术和逻辑运算

     加密流程：

     - 初始置换（$IP$）
     - 子密钥生成
     - 16轮迭代：
       - 扩展置换（E 盒置换）：将32位扩展成48位；输入的一位影响下一步的两个替换，使得输出对输入的依赖性传播得更快，密文的每一位都依赖于明文的每一位
       - S 盒代换：将48位压缩成32位
       - P 盒置换：32位输入32位输出
     - 逆初始置换（$IP^{-1}$）

   - 3DES：

     密钥长度是112bit或168bit

     迭代次数48

   - RC4：

     密钥长度可变的流加密算法簇；该算法速度是DES算法的10倍

     RC4算法关键是根据密钥产生伪随机bit流：使用了一个256位的转换器（S-BOX）；两个指针

     关键算法：

     - 密钥调度算法
     - 伪随机流产生算法

5. **非对称密码算法：**

   - RSA 算法：

     RSA安全性基于分解极大数的困难性

     至今，只有短的RSA密钥才可以被强力破解；至今世界上还没有可靠攻击RSA算法的方式

     只要密钥足够长，RSA加密的信息在计算上不能被破解

     加解密流程：

     - 密钥生成：
       - 随机选择两个不相等的素数 $p$ 和 $q$
       - 计算 $n=p \times q$ 和 $\phi(n)=(p-1)(q-1)$
       - 随机选择一个整数 $e$ 使得 $gcd(e,\phi(n))=1$（任意大于 $p$ 和 $q$ 的素数都可以）
       - 计算 $d=e^{-1} \pmod {\phi(n)}$（若知道 $e$ 和 $\phi(n)$ 则很容易计算出 $d$）
       - 公钥为 $(n,e)$，私钥为 $d$
     - 加密：加密明文 $m$ 为 $c=m^e \pmod n$
     - 解密：解密密文 $e$ 为 $m=c^d \pmod n$

6. **单向散列函数（Hash函数）：**

   - 概念：

     Hash 函数 $h()$ 是一个有效的计算方法，它将一个任意长度的二进制位串影射成固定长度的二进制位串，这个固定长度的二进制位串叫 Hash 值
     
   - 修改发现码（MDC）：

     在一般 Hash 函数的基础上加入以下附加性质：

     - Hash 函数是单向函数，即给定 $y$，找到任意 $x$，满足 $y=h(x)$ 计算不可能
     - 已知 $x$，找 $x'$，满足 $h(x)=h(x')$ 计算不可能
     - 找一任意对 $x$ 和 $x'$ ，满足 $h(x)=h(x')$ 计算不可能

     消息发现码没有秘密密钥

   - 消息认证码（MAC）：

     消息认证码的目的通俗讲就是不附加任何其它机制，确保消息来源的真实性的 Hash 函数

     消息认证码有两个不同功能的参数，即消息和秘密密钥

   - 特点：

     - 可以操作任意长度内容 $m$
     - 给定 $m$，计算 $h$ 是容易的
     - 给定任意 $m$，产生的 $h$ 的长度固定
     - 给定 $h$，寻找 $m’$，使得 $h = H(m’)$ 是困难的
     - 寻找任何 $(m,m’) ,m≠m’$ ，使得 $H(m) =H(m’)$ 计算上不可行

   - 常见的单向散列函数：

     MD2、MD4、MD5；SHA-0、SHA-1；SHA-256/224、SHA-512/384

   - MD5（Message Digest 5）算法：

     对任意输入均产生128bit的输出

     基于32位的简单操作，易于软件实现

     128位的信息摘要找到“碰撞”是可能的

     算法步骤：

     - 填充，使报文的长度为512减64位
     - 将填充前的长度写入最后64位，总长为512整数倍
     - 初始化4个32位寄存器
     - 处理每个报文分组，核心是4轮循环的压缩函数
     - 所有L 个512bit的分组处理完之后，第L阶段的输出便是128bit的报文摘要

   - SHA（Security Hash Algorithm）算法：

     SHA-0和SHA-1算法产生160位的摘要信息（散列值）

     单次输入信息最长（264−1）位

     SHA-1在安全协议中广为使用:TLS/SSL、PGP、SSH和IPSec

     SHA-1被视为MD5的后继者

## 访问控制和防火墙技术

1. **访问控制原理：**

   访问可以被描述为一个三元组 $(S,O,A)$ 分别代表：

   - 主体（Subject）：提出资源访问请求的对象
   - 客体（Object）：被访问的资源实体
   - 访问（Access）：对资源的使用

   访问控制是信息安全保障机制的核心内容，它是实现数据保密性和完整性机制的主要手段

   访问控制机制决定用户及代表一定用户利益的程序能做什么 ，及做到什么程度。

   访问控制模型：

   - 自主访问控制（DAC）：

     - 每一个客体都有一个所有者，所有者可以按照自己的意愿把可以按照自己的意愿把客体的访问控制权限授予其它主体

     - 控制灵活，易于管理，是目前应用最为普遍的访问控制策略

     - DAC的有效性依赖于资源的所有者对安全政策的正确理解和有效落实

   - 强制访问控制（MAC）：

     - 每个主体和客体分配一个固定的安全级别，只有系统管理员才可以修改
     - 只有在主体和客体的安全级别满足一定规则时，才允许访问
     - 常用于军队和政府机构
     - 特点：
       - 禁止向下写
       - 禁止向上读
       - 低安全级信息向上流动
       - 高读低合法，有安全漏洞

   - 基于角色的访问控制（RBAC）：

     - 根据任务需要定义角色；为角色分配资源和操作权限；给一个用户组指定一个角色
     - RBAC通过角色，隔离了主体和权限

   访问控制的设计原则：

   - 最小特权原则：

     每一用户和进程只应拥有最小访问权的集合，只能在为完成其任务所必须的那些权限所组成的最小保护域内执行

     这一原则能够限制差错或恶意攻击产生的危险，是抑制特洛伊木马和实现可靠程序的基本措施

     方便程序的正确性证明和维护，因为程序能涉及的范围减少了，使得证明与维护中考虑的因素相应地减少了

   - 开放式设计原则：

     机制的安全性不应建立在秘密设计或攻击者的无能上，例如密码系统的设计

     任何秘密应在口令或密钥中，而不是在机制本身

     公开性的设计可以受到许多专家的审查与验证，也可以在用户间增加信任感

   - 特权的分隔原则：

     如有可能，对客体的访问应取决于不止一个条件被满足，即把访问某个客体的权利分解为多个子权利，分别由不同的主体掌握，只有这些子权利同时满足才能对客体进行访问

   - 公共机制的最小化原则：

     公共机制是指由多用户共享的机制

     提供了隐蔽信道的可能性，不利于系统安全，应该最小化

     这一原则产生了提供分隔各用户的隔离机制

   - 经济性原则

   - 心理可接受原则

2. **防火墙技术概述：**

   防火墙的概念：

   - 防火墙是在两个网络（通常是用户内部网络和Internet）之间实施访问控制政策的一个或一组系统（硬件、软件的组合）
   - 在两个信任程度不同的网络之间设置的、用于加强访问控制的软硬件保护设施
   - 能根据有关的安全政策控制（允许、拒绝、监视、记录、限流等）进出网络的访问行为

   软件防火墙和硬件防火墙：

   - 硬件防火墙：它是指把防火墙程序做到芯片里面由硬件执行这些功能，能减少CPU的负担，使路由更稳定。价格较贵，但效果较好，适用于中大型企业
   - 软件防火墙：速度较慢，适合单机。通过软件的方式来实现，价格较低，但这类防火墙只能通过一定的规则来达到限制一些非法用户访问内部网的目的。

   防火墙的作用：

   - 防火墙可以在网络边界实施访问控制政策
   - 防火墙可以记录所有的访问
   - 防火墙可以隐藏内部网络，限制暴露内部用户点

   防火墙的局限：

   - 防火墙自身不会正确的配置，需要用户定义访问控制规则
   - 防火墙防外不防内，不能防止内部恶意的攻击者
   - 防火墙无法控制没有经过它的连接
   - 防火墙无法防范全新的威胁和攻击
   - 防火墙不能很好的实现内容防范，比如病毒等

   防火墙的争议：

   - 防火墙破坏了Internet端到端的特性，阻碍了新应用的发展
   - 防火墙没有解决主要的安全问题，即网络内部的安全问题
   - 防火墙给人一种误解，降低了人们对主机安全的意识

   防火墙的发展趋势：

   - 优良的性能，支持万兆网络（10Gbps）
   - 可扩展的结构和功能，与网络入侵检测等系统联动
   - 简化的安装与管理
   - 主动过滤（被动过滤：根据黑名单操作）
   - 通过DPI（深度包检测）技术来防病毒与防黑客

3. **防火墙核心技术：**

   包过滤技术（Packet Filtering）：

   - 工作在网络层，基于如下信息对每一个包进行检查：
     - IP 源地址和目标地址
     - TCP/UDP源端口号和目标端口号
     - 协议（TCP, UDP,ICMP, BGP等）
     - ICMP的消息类型
     - 包的大小
   - 在判断数据包时不关心包具体内容，可完成类似操作：
     - 不让任何用户从外部网用Telnet登录
     - 允许任何用户使用SMTP往内部网络发送电子邮件
     - 不让用户登录和使用QQ等即时通信软件
     - 不让用户访问特定网站
   - 不能完成类似操作：
     - 允许某个用户从外部网用Telnet登录而不允许其他用户登录
     - 允许用户传送一些文件而不允许用户传送其他文件
   - 优点：
     - 可以保护所有的服务
     - 对应用透明
     - 较高的网络性能
     - 成本较低
   - 缺点：
     - 无法实施细粒度的访问控制政策
     - 不能防止IP欺骗
     - 规则配置复杂
     - 降低路由器的性能

   应用层代理（Proxy）：

   - 特点：
     - 针对特定协议，比如telnet , http , smtp , pop等
     - 可以支持身份认证功能
     - 除了基于地址、协议、端口的控制以外，还可以支持应用层命令的过滤，比如FTP的GET, PUT等
   - 优点：
     - 参与TCP连接的全过程
     - 在应用层上建立协议过滤
     - 保持状态，可以检测并防范SYN Flood攻击
   - 缺点：
     - 速度相对较慢
     - 性能的开销较大
     - 防火墙本身易受攻击

   地址转换（NAT）：

   - 特点：
     - 工作在网络层
     - 除了转发以外，完成地址转换
     - 不能提供额外的安全性，但是可以隐蔽内部网络
   - 转换方式：
     - 静态地址转换
     - 动态地址转换
     - 静态地址转换+端口映射
     - 动态地址转换+端口映射
   - 优点：
     - 节省IP地址资源
     - 隐蔽内部的网络
   - 缺点：
     - 地址转换破坏了IP包的完整性
     - 动态地址转换必须保留状态
     - Log 变得困难
     - 端口映射使得包过滤变得困难

4. **防火墙部署：**

   基本概念：

   - 非军事区（Demilitraized Zone, DMZ）：作用是把单位的FTP服务器、E-Mail服务器等允许外部访问的服务器单独部署在此区域，使整个需要保护的内部网络接在信任区后，不允许任何外部网络的直接访问，实现内外网分离，满足用户的安全需求
   - 双机热备：增加系统的鲁棒性（可靠性）
   - 部署原则：网络环境、经济能力、安全级别等

   普通企业环境：

   <img src="/Users/hyperzsb/Library/Application Support/typora-user-images/image-20210510100224445.png" alt="image-20210510100224445" style="zoom: 50%;" />

   家庭或中小企业环境：

   <img src="/Users/hyperzsb/Library/Application Support/typora-user-images/image-20210510100314826.png" alt="image-20210510100314826" style="zoom:50%;" />

   单防火墙实现多网络接入：

   <img src="/Users/hyperzsb/Library/Application Support/typora-user-images/image-20210510100330623.png" alt="image-20210510100330623" style="zoom:50%;" />

   双防护墙实现多网络接入：

   <img src="/Users/hyperzsb/Library/Application Support/typora-user-images/image-20210510100346025.png" alt="image-20210510100346025" style="zoom:50%;" />

   双防火墙热备份方式：

   <img src="/Users/hyperzsb/Library/Application Support/typora-user-images/image-20210510100440336.png" alt="image-20210510100440336" style="zoom:50%;" />

   双防火墙负载均衡：

   <img src="/Users/hyperzsb/Library/Application Support/typora-user-images/image-20210510100408515.png" alt="image-20210510100408515" style="zoom:50%;" />

   双防火墙深度部署：

   <img src="/Users/hyperzsb/Library/Application Support/typora-user-images/image-20210510100500508.png" alt="image-20210510100500508" style="zoom:50%;" />

   整体链路的冗余配置：

   <img src="/Users/hyperzsb/Library/Application Support/typora-user-images/image-20210510100514817.png" alt="image-20210510100514817" style="zoom:50%;" />

   分布式网络环境的部署：

   <img src="/Users/hyperzsb/Library/Application Support/typora-user-images/image-20210510100528223.png" alt="image-20210510100528223" style="zoom:50%;" />

   与病毒服务器的联动：

   <img src="/Users/hyperzsb/Library/Application Support/typora-user-images/image-20210510100548352.png" alt="image-20210510100548352" style="zoom:50%;" />

   与IDS的联动：

   <img src="/Users/hyperzsb/Library/Application Support/typora-user-images/image-20210510100602285.png" alt="image-20210510100602285" style="zoom:50%;" />

   支持第三方认证服务器：

   <img src="/Users/hyperzsb/Library/Application Support/typora-user-images/image-20210510100625214.png" alt="image-20210510100625214" style="zoom:50%;" />

## 协议安全和VPN技术

1. **网络协议安全分析：**

   网络层：

   - IPv4协议在设计之初没有考虑安全性
   - IP包本身不具备任何安全特性
   - 网络层的安全威胁主要有IP欺骗和ICMP攻击

   传输层：

   - TCP和UDP，在设计之初没有考虑安全性
   - SYN Flood泛洪攻击

   应用层：

   - Telnet：以明文的方式发送所有的用户名和密码
   - FTP：FTP的可写匿名连接是黑客寻找的目标

   互联网安全隐患的根源是TCP/IP协议的缺陷：

   - 网络层、传输层存在安全性上的设计缺失
   -  应用层存在大量的安全隐患，可弥补
   - 如何在网络层、传输层提高Internet的安全性：
     - 网络层：IPSec协议族
     - 传输层：SSL/TLS协议族

2. **安全协议IPSec：**

   概述：

   - Internet Protocol Security

   - 将密码安全机制引入IP协议

   - IPSec主要对IP协议分组进行加密和认证

   - 对IPv6是必须的，对IPv4是可选的

   IPSec包含的具体协议：

   - AH（认证头）协议：对整个数据包（除部分字段）进行认证；AH没有加密性：

     <img src="/Users/hyperzsb/Library/Application Support/typora-user-images/image-20210510101136134.png" alt="image-20210510101136134" style="zoom:50%;" />

     <img src="/Users/hyperzsb/Library/Application Support/typora-user-images/image-20210510101209599.png" alt="image-20210510101209599" style="zoom:50%;" />

   - ESP（封装安全载荷）协议：对网络包有效载荷（payload）进行加密：

     <img src="/Users/hyperzsb/Library/Application Support/typora-user-images/image-20210510101254581.png" alt="image-20210510101254581" style="zoom:50%;" />

     <img src="/Users/hyperzsb/Library/Application Support/typora-user-images/image-20210510101358410.png" alt="image-20210510101358410" style="zoom:50%;" />

   IPSec的工作模式：

   - 传输模式：
     - 在主机上实现，与操作系统集成；针对用户每个会话提供安全保障
     - 传输模式用于两台主机之间，保护端到端的安全
     - 只对IP数据包的有效负载进行加密或认证
     - 继续使用以前的IP头部，只对IP头部的部分域进行修改
     
     <img src="/Users/hyperzsb/Library/Application Support/typora-user-images/image-20210510100943343.png" alt="image-20210510100943343" style="zoom:50%;" />
     
     
     
   - 隧道模式：
     - 无需改变操作系统；为局域网内部所有应用提供服务
     - 主机与路由器或路由器之间，保护整个IP数据包
     - 对整个IP数据包进行加密或认证
     - 需要新产生一个IP头
     
     <img src="/Users/hyperzsb/Library/Application Support/typora-user-images/image-20210510101013217.png" alt="image-20210510101013217" style="zoom:50%;" />

3. **安全协议SSL（TLS）：**

   概述：

   - SSL：Secure Sockets Layer，安全套接层
   - TSL：Transport Layer Security，传输层安全
   - 保证网络通信提供安全及数据完整性的安全协议
   - TLS和SSL在传输层对网络连接进行加密，与应用层协议无关

   SSL的通信目标：

   - 机密性：SSL客户机和服务器之间的数据都经过了加密处理，网络中非法窃听者获得的都是加密后的密文
   - 完整性：利用密码算法和散列（Hash）函数保证数据的完整性
   - 不可否认性：利用证书技术和可信的第三方认证，可以让客户机和服务器相互识别对方的身份，SSL要求证书持有者在握手时交换数字证书

   SSL的组成：

   - 记录协议：
     - 为各种高层协议提供基本的安全服务
     - 应用程序消息被分割成可管理的数据块（可以选择压缩数据），并产生一个消息鉴别信息，加密，插入新的文件头，最后在TCP中加以传输;接收端将收到的数据解密，做身份验证、解压缩、重组数据报然后交给高层应用进行处理
   - 握手协议：
     - Client Hello：客户端将其SSL版本号、加密设置参数，与session有关的数据以及其它一些必要信息（如加密算法和能支持的密钥的大小等）发送到服务器
     - Server Hello：服务器将其SSL版本号、加密设置参数、与session有关的数据以及其它一些必要信息发送给客户端
     - Certificate：服务器发送一个证书或一个证书链到客户端
     - Certificate Request：该消息要求客户端浏览器提供用户证书
     - Server Key Exchange：如果服务器发送的公共密钥对加密密钥的交换不是很合适时，则发送一个服务器密钥交换信息
     - Server Hello Done：该消息通知客户端，服务器已完成了交流过程的初始化
     - Certificate：客户端发送客户端证书给服务器
     - Client Key Exchange：客户端产生一个会话密钥与服务器共享
     - Certificate Verify：如果服务请求验证客户端，这个消息允许服务器完成验证过程
     - Change Cipher Spec：客户端要求服务器在后续的通讯中使用加密模式
     - Finished：客户端告诉服务器它已经准备好安全通信了
     - Change Cipher Spec：服务器要求客户端在后续的通讯中使用加密模式
     - Finished：服务端告诉客户端它已经准备好安全通信了。这是SSL“握手”完成的标志
     - Encrypted Data：开始在安全通信通道上进行加密信息的交流
   - 密钥更改协议：
   - 告警协议：

4. **VPN技术：**

   概述：

   - VPN：Virtual Private Network，虚拟专用网
   - 常用于连接中大型企业或团体内部网络的通讯方法
   - 利用公共IP网络建立局域网络
   - 可“地理分布”的局域网络
   - 为保证在VPN中传输数据的私密性，需要引入安全协议
   - 安全性是VPN技术的重要组成部分

   VPN的优势：

   - 安全性：非常高，保护数据传输的完整性、保密性、不可抵赖性
   - 可扩展性：基于TCP/IP技术，只要网络可达，就可以方便扩展
   - 投资成本：设备一次性投入，不需要支出每月的运营费用
   - 移动支付：能对Internet上的内部移动用户安全接入，彻底消除地域差异

   VPN的应用：

   - 可以帮助远程用户、公司分支机构、商业伙伴及供应商同公司的内部网建立可信的安全连接，并保证数据的安全传输
   - 通过将数据流转移到低成本的网络上，一个企业的虚拟专用网解决方案将大幅度地减少用户费用
   - 虚拟专用网还可以保护现有的网络投资

   VPN的关键技术：

   - 隧道技术
   - 加解密技术
   - 认证技术

   VPN的种类：

   - SSL/TLS VPN：
     - 只需80/443 端口即可
     - 只需浏览器即可访问
     - 不受任何网络配置影响
   - IPSec VPN：
     - 需要改变防火墙配置
     - 受网络环境以及用户端配置影响
     - 用户端需要安装客户端软件

   - IPSec VPN与SSL VPN对比：

     |                                |  IPSec VPN   |    SSL VPN     |
     | :----------------------------: | :----------: | :------------: |
     | 需要安装、配置并管理客户端软件 |     需要     |     不需要     |
     |            维护成本            |      高      |       低       |
     |  防火墙需要改变和配置安全策略  |     很多     |      极少      |
     |      可以进入所有内部网络      |     可以     |     不可以     |
     |      任何计算机都可以使用      |    不可以    |      可以      |
     |          初始设备投资          |     相同     |      相同      |
     |           客户端安装           |    费用高    | 不需要安装费用 |
     |        大量远程用户推广        | 困难，费用高 |    简单方便    |
     |          网络安全等级          |      好      |      更好      |
     |         与应用系统整合         |     困难     |      简单      |
     |           系统扩充性           |     具备     |      具备      |
     |        用户端使用便利性        |     麻烦     |      简单      |

## 计算机病毒和防病毒技术

1. **计算机病毒概述：**

   计算机病毒的定义：

   - 破坏计算机功能或者毁坏数据，影响计算机使用，并能自我复制的一组计算机指令或者程序代码

   恶意软件与计算机病毒：

   - 恶意软件通常指“流氓软件”，而由于早期的恶意程序大多数为计算机病毒，因此广义“计算机病毒” 还包含蠕虫、木马等恶意程序

   计算机病毒的动机：

   - 恶作剧
   - 报复心理
   - 军事目的
   - 政治目的：破坏敌国工业控制系统，造成能源损耗或产量降低
   - 经济目的：利用电脑病毒从事经济犯罪；窃取竞争对手的电脑系统中的机密信息，或修改电脑中的数据；挪用款项，或破坏竞争对手的电脑系统；盗取他人的虚拟财产

   计算机病毒的特点：

   - 传染性：传染性是病毒的基本特征；但进入计算机系统并运行，就会搜寻其他符合其传播条件的程序或者存储介质，确定目标后，将其自身代码插入其中
   - 潜伏性：绝大多数计算机病毒感染系统后不会马上发作
   - 破坏性：降低计算机工作效率、占用系统资源、导致系统崩溃等
   - 隐藏性：最大的病毒程序不超过1MB，一般在1KB左右。病毒一般藏在用户不常去的系统文件中，或者和其他程序绑定到一起，实现隐藏
   - 可激发性：绝大多数计算机病毒具有发作的设置条件
   - 未经授权而执行：病毒隐藏在正常程序中，当用户调用正常程序时窃取到系统的控制权，先于正常程序执行

2. **计算机病毒的种类：**

   病毒：

   - 在执行时设法将自己复制到其他可执行代码中的恶意软件
   - 当被感染的可执行代码运行时，病毒也会同时被执行
   - 宏病毒、脚本病毒
   - 宏病毒可以感染用于支持各种用户文档类型的活动内容的脚本代码， 属于脚本病毒的一种
   - 红色代码（Script.Redlof）、欢乐时光（VBS.Happytime）

   蠕虫（Worm）：

   - 能够独立执行并且可以将完整执行版本传播到网络中其他主机上的计算机程序
   - 冲击波（阻塞网络），小邮差（发带毒邮件）

   特洛伊木马（Trojan）：

   - 一种看似完成有用功能的程序，但具有隐蔽的、潜在的恶意功能，可以用来避开安全机制检查
   - 木马是一种特殊的程序，它们不感染文件，不自身复制和传播，甚至不破坏系统，是一个具有特定功能的可以里应外合的后门程序

   数据损坏和勒索软件：

   - CIH病毒：覆盖硬盘前1024K字节的数据，大面积损坏文件系统
   - WannaCry勒索软件：加密大量满足列表中文件类型要求的文件，然后索取比特币赎金来恢复

   肉鸡、僵尸机：

   - 可以用于分布式拒绝攻击、垃圾邮件发送、挖矿、嗅探敏感信息流量、安装广告插件、操作在线投票

   间谍软件：

   - 通过钓鱼网站、键盘记录器等窃取账户密码等隐私数据。对于入侵工业系统或商业系统的病毒类型，也会尝试入侵数据库以获取工业或商业机密信息

   后门：

   - 后门多用于程序员合理的调试及测试过程。后门被获取后可用于为其他载荷提供权限并隐藏其进程

3. **计算机病毒的原理：**

   计算机病毒的逻辑结构：

   - 感染机制：

     是指计算机病毒由一个载体传播到另一载体，由一个系统进入另一个系统的过程

     主要的感染方式有：

     - 病毒程序利用操作系统的引导机制或加载机制进入内存
     - 内存的病毒感染新的存储介质或程序文件，利用操作系统的读写磁盘的中断或加载机制来实现
     - 使用特定应用程序，执行宏代码或脚本语言实现特定功能

     当病毒发现被传染的目标时，进行如下操作：

     - 首先对运行的可执行文件特定地址的标识位信息进行判断是否已感染了病毒
     - 当条件满足, 解析PE格式将病毒链接到可执行文件的首部或尾部或中间, 并存入磁盘中
     - 完成传染后, 继续监视系统的运行, 试图寻找新的攻击目标

   - 引导机制

   - 触发机制：

     - 利用中断向量：在设计原则、工作原理上与传染机制基体相同，通过修改某一中断向量入口地址，使其指向病毒程序的破坏模块
     - 利用系统函数：采用高级语言开发，利用DOS命令、系统函数等实现破坏

   - 有效载荷

4. **计算机病毒的防范：**

   特征代码法：

   - 选取病毒中最具代表性的程序片段，通常采用16进制表示
   - 利用已知病毒的特征代码来检测病毒
   - 检测已知病毒的最简单、开销最小的方法
   - 特点：
     - 速度慢
     - 误报警率低
     - 不能检查多态病毒及变形病毒
     - 不能对付隐蔽性病毒

   校验和法：

   - 将正常文件的内容，计算其校验和(或对其进行认证)
   - 在文件使用过程中，定期地或每次使用文件前，检查文件现在内容算出的校验和与原来保存的校验和是否一致

   行为监测法：

   - 利用病毒的特有行为特征来监测病毒的方法，例如：占有INT 13H、修改注册表
   - 优点：可发现未知病毒、可准确地预报未知的多数病毒
   - 缺点：可能误报警、不能识别病毒名称、实现有难度

   杀毒引擎：

   - 病毒集合 $A$，特征码集合 $B$，如果按照某种对应法则 $f$， 对于集合 $A$ 中的病毒，在集合 $B$ 中有特征码和它对应， 法则 $f$ 即为杀毒引擎
   - 评价指标：
     - 病毒集合中的病毒是否能够命中
     - 特征码冗余度
     - 速度

   主动防御系统：

   - 行为监测法：可以防御未知病毒、未知威胁、ZeroDay攻击等
   - 边界扫描处理：只能够扫描恶意软件内容，并不能对运行在被感染系统中的恶意程序所表现的行为进行遏制
   - 入口监控软件：使用异常特征或启发式方式进行恶意程序流量检测
   - 出口监控软件：通过监控输出通信中是否存在扫描或其他可疑行为来捕获恶意程序攻击源头

   云计算杀毒（云安全）：

   - 云计算杀毒的实质是：杀毒软件的互联网化

## 缓冲区溢出和渗透测试

1. **缓冲区溢出概述：**

   概述：

   - 缓冲区溢出、社会工程学、DDoS至今无解。是真正的“杀手锏”技术
   - 缓冲区：包含相同数据类型实例的一个连续的计算机内存块或程序运行期间在内存中分配的一个连续的区域

2. **缓冲区原理：**

   <img src="/Users/hyperzsb/Library/Application Support/typora-user-images/image-20210510101639903.png" alt="image-20210510101639903" style="zoom:50%;" />

   <img src="/Users/hyperzsb/Library/Application Support/typora-user-images/image-20210510101706975.png" alt="image-20210510101706975" style="zoom:50%;" />

   <img src="/Users/hyperzsb/Library/Application Support/typora-user-images/image-20210510101734458.png" alt="image-20210510101734458" style="zoom:50%;" />

   <img src="/Users/hyperzsb/Library/Application Support/typora-user-images/image-20210510101817365.png" alt="image-20210510101817365" style="zoom:50%;" />

   <img src="/Users/hyperzsb/Library/Application Support/typora-user-images/image-20210510101839486.png" alt="image-20210510101839486" style="zoom:50%;" />

   种类：

   - 栈溢出：

     最常用

     栈溢出的条件：

     - 使用特定函数：gets(), strcpy(), scanf(), fscanf(), sscanf()

     溢出的防范：

     - 限制字符串读写长度：使用安全函数
     - 限制在栈区域代码执行的权限：栈区域内，代码不可执行

   - 堆溢出：

     堆溢出不如栈溢出流行：

     - 比栈溢出难度更大

     - 对内存中变量的组织方式有一定要求

   - BSS溢出

3. **缓冲区溢出的利用：**

   在程序的地址空间安排适当代码

   使控制流跳转到攻击代码

   集中缓冲区溢出模式：（N：填充数据；S：ShellCode；R：返回地址；A：环境变量）

   - NRS模式
   - RNS模式
   - AR模式：必须将ShellCode放在环境变量中

   填充代码构成：

   - ShellCode：
     - 完成特殊任务的自包含的二进制代码
     - shellcode一般用于获得系统特殊权限
   - 返回地址：
     - 指shellcode的入口地址
     - 不同的返回地址均处于某个较小的地址区间。为了提高成功率，往往使用重复地址内容
   - 填充数据：
     - 辅助shellcode和返回地址
     - 一般使用对执行结果没有影响的操作；使用最多的是NOP，值为0x90

## 黑客攻防和入侵检测技术

1. **网络黑客概述：**

2. **网络攻击概述：**

   网络攻击的步骤：

   - 隐藏IP：
     - 入侵到其他电脑上，利用它进行攻击（肉鸡、傀儡机）
     - 多级跳板，代理服务器（Sock代理）
   - 踩点扫描：
     - 通过多种途径了解攻击目标的各方面情况
     - 公众域信息、NIC 注册纪录、DNS 纪录、 SNMP 扫描、OS 识别、社会工程学
     - 主要方法：端口扫描
       - 端口扫描原理：检查目标主机在哪些端口可以建立TCP 连接，如果可以建立连接，则说明主机在那个端口被监听
       - 防范：关闭闲置及危险端口、屏蔽出现被扫描症状的端口
       - 常用工具：nmap
       - 扫描类型：慢扫描、随机扫描、碎片扫描、诱骗扫描、TCP扫描、UDP扫描、协议栈扫描、SYN扫描、Null扫描、Xmas Tree扫描、FIN扫描、分布式扫描、快扫描、 ACK扫描、Windows扫描、RPC扫描、反向扫描、Idle扫描、ftp bounce扫描
   - 获得特权：
     - 由系统/管理/软件漏洞获得系统权限
     - 由监听获得敏感信息，进一步获得相应权限
     - 以弱口令/穷举法获得远程管理员的用户密码
     - 攻破目标机信任的另一台机器，进而获得目标机控制权
     - 由欺骗或其他方式获得权限
   - 种植后门：
     - 目的：保持对被入侵计算机的长久控制
     - Rootkit，针对Unix和Linux操作系统的后门程序组
   - 隐身退出：
     - 不被管理员发现，清楚登陆日志及其它相关日志
     - 注意：删除本次攻击相关的日志，而不是全部日志
     - 寻找不进行日志记录的代理服务器

3. **常见的黑客攻防技术：**

   网络攻击分类：

   - 非直接攻击:

     - 社交工程学的欺骗
     - 网络钓鱼技术
     - 拒绝服务攻击：DoS、DDoS；SYN Flood泛洪攻击、ICMP Smurf（直接广播）、TARGA3（堆栈突破）
       - SYN Flood：是当前最流行的DoS与DDoS的方式之一， 这是一种利用TCP协议缺陷，发送大量伪造的TCP连接请求，从而使得被攻击方资源耗尽（CPU满负荷或内存不足）的攻击方式
       - ICMP Smurf（直接广播）：这种攻击方法结合使用了IP欺骗和ICMP回复方法使大 量网络传输充斥目标系统，引起目标系统拒绝为正常系统进行服务；Attacker向一个具有大量主机和Internet连接的网络的广播地址发送一个欺骗性Ping分组(echo 请求)，这个目标网络被称为反弹站点，而欺骗性Ping分组的源地址就是攻击者希望攻击的系统
       - TARGA3（堆栈突破）：基本原理是发送TCP/UDP/ICMP的碎片包；碎片包的大小、标记、数据等都是随机的；一些有漏洞的系统内核由于不能正确处理这些极端不规范数据包，便会使其TCP/IP堆栈出现崩溃，从而导致无法继续响应网络请求（即拒绝服务）

   - 前门攻击：

     - 特殊字符绕过口令验证：

       ```sql
       select * from table where password=(‘ 1 ‘) or (’ 1‘=’1 ‘)
       ```

     - 暴力口令猜解:

       - 猜测简单口令
       - 字典攻击
       - 暴力猜测

     - 本地文件密码破解:

       - QQ聊天记录破解
       - Foxmail账户口令清除
       - Word、pdf文件密码清除

     - 从网络中直接嗅叹收集密码：

       - Telnet协议中明文传递密码
       - Email内容
       - MSN、QQ、飞信等的聊天内容
       - 云端密码破解（手机云服务最危险）

   - 后门攻击：

     - 木马程序

     - SQL注入攻击：

       利用现有应用程序，将（恶意的）SQL命令注入到后台数据库引擎，并获得执行

       主要原因：开发人员水平和经验不同

       基本过程：

       - 判断Web环境是否可以SQL注入
       - 寻找SQL注入点，输入一些特殊语句，看错误信息
       - 猜测用户名和密码，利用表名、字段名等信息
       - 寻找Web管理后台入口

     - ARP欺骗攻击：

       原理：错误关联IP地址和MAC地址的关系

       方法一：发送含有错误IP或MAC地址的伪包给路由或网关

       方法二：伪造网关，接受其他计算机向它发送数据

4. **入侵检测系统概述：**

   为什么需要入侵检测系统：

   - 防火墙是网络系统的第一道安全闸门
   - 当开放特定端口后，防火墙无法区应用类型
   - 需要更深层次的防御技术

   什么是入侵检测：

   - 入侵：在非授权的情况下，试图存取信息、处理信息或破坏系统以使系统不可靠、不可用的故意行为
   - 入侵检测：对企图入侵、正在进行的入侵或已经发生的入侵进行识别的过程
   - 作为增强网络系统安全性和追究入侵者法律责任的依据
   - 它从计算机网络系统中的若干关键点收集信息，并分析这些信息，检查网络中违反安全策略的行为和遭到袭击的迹象

   什么是入侵防御：

   - 可以理解为：实时入侵检测系统
   - 以实时发现并阻断入侵为主要目的，取证为次要目的
   - 当发现网络入侵现象，可以采用适当的方式进行攻击阻断（相当于：入侵检测与防火墙的联动）

   入侵检测系统的作用：

   - 监控网络和系统
   - 发现入侵企图或异常现象
   - 实时报警
   - 主动响应
   - 审计跟踪

   入侵检测系统的分类：

   - 入侵检测系统根据数据来源的不同，采用不用的实现方式，一般地可分为主机型、网络型和混合型
   - 基于主机的入侵检测系统（HIDS：Host-based IDS）：
     - 信息来源：
       - 系统状态信息（CPU, Memory, Network）
       - 审计信息，登录认证、操作审计，如syslog等
       - 应用系统提供的审计记录
     - 缺点：
       - 需要在主机上运行，占用系统资源
       - 多数是事后的分析，实时性差
       - 和操作系统相关，很难支持异构平台
     - 改进：
       - 分布式方式，每台机器中安装代理（Agent）
   - 基于网络的入侵检测系统（NIDS：Network-based IDS）：
     - 信息来源：
       - 从网络中获取的网络包
     - 优点：
       - 旁路监听方式工作，不影响网络性能
       - 分析网络数据，与操作系统无关
     - 基本架构：
       - 协议分析+模式匹配
     - 分布于网络中的重点主机和边界
   - 混合型入侵检测系统（Hybrid IDS）：
     - 需要考虑不同入侵检测Agent之间的协调
     - 不同类型检测系统有不同的记录格式：基于网络和主机
     - 检测数据传输的保密性和完整性，比如SNMP数据等
     - 层级结构的组织

5. **入侵检测/防御方法：**

   分类：

   - 误用检测（Misuse Detection）：
     - 通过检测用户行为中与已知入侵行为模式类似的行为来检测系统中的入侵活动，是一种基于已有知识的检测
     - 根据已知的攻击方法或系统安全缺陷方面的知识，建立特征（Signature）数据库，然后在收集到的网络活动中寻找匹配的使用模式（Pattern）
     - 优点：
       - 准确率较高
       - 速度较快
     - 缺点：
       - 只能检测已知的攻击
   - 异常检测（Abnormal Detection）：
     - 非规则检测建立在如下假设的基础上：入侵行为与合法用户或者系统的正常或者期望的行为有偏差
     - 正常的行为模式可以从大量历史活动分析统计得到
     - 任何不符合以往活动规律的行为都被视为是入侵行为
     - 优点：
       - 能够检测出未知的攻击
     - 缺点：
       - 误报率很高

   常见入侵检测系统：

   - Snort：
     - 第一个成熟的开源网络入侵检测系统
     - 支持多种平台：Linux、Solaris、Windows
     - 利用libpcap捕获数据包
     - 基于规则的检测方法，可以检测出缓存溢出、端口扫描、等多种攻击，目前有5000多条常用规则
   - IDES（Intrusion Detection Expert System）：
     - 目标系统根据用户的活动产生审计数据，用一种专用的格式
     - 调用统计分析和规则分析两个部件来检测是否存在异常
     - 一旦检测出异常就通过用户界面向管理员告警
     - 特点：
       - 同时使用了统计的方法和基于规则的方法
       - 使用了统计的记录格式，独立于被监控的系统平台
     - 检测方式：
       - 根据主体的历史档案判断用户的行为是否偏离了过去的行为模式或习惯
       - 每次审计记录接收以后，计算N维空间中当前事件与档案中的统计值之间的距离是否超过设定的阈值
   - BRO：
     - 开源的网络入侵检测系统
     - 与Snort不同，BRO的规则库采用正则表达式描述
   - Suricate

   入侵检测系统的发展方向：

   - 基于特征匹配的入侵检测系统已经产品化
   - 基于统计的异常检测技术还有待于进一步的研究
   - 抗攻击性
   - 针对大规模网络部署的可扩展性
   - 高带宽网络流量的处理能力
   - 基于虚拟化的蜜罐式入侵检测系统

6. **入侵检测/防御系统的部署：**

   <img src="/Users/hyperzsb/Library/Application Support/typora-user-images/image-20210510102538029.png" alt="image-20210510102538029" style="zoom:50%;" />

   部署要求：
   
   - 不同于防火墙，IDS入侵检测系统是一个监听设备
   - 对IDS的部署，唯一的要求是：IDS应当挂接在所有所关注流量都必须流经的链路上

   NIPS的部署要求：
   
   - 网络入侵防御系统是一种在线部署的产品
   - 提供主动的、实时的防护，其设计目标旨在准确监测网络异常流量，自动对各类攻击性的流量，尤其是应用层的威胁进行实时阻断，而不是简单地发出告警
   - IPS是通过直接串联到网络链路中而实现这一功能的

   NIDS和NIPS的区别：
   
   - 功能上：NIPS能够及时阻止入侵
   - 性能上：NIPS性能更为敏感
   - 实现上：NIPS需要维护流表，NIDS不需要，开销不同
   
   一版网络环境中的NIPS部署：
   
   <img src="/Users/hyperzsb/Library/Application Support/typora-user-images/image-20210510102657206.png" alt="image-20210510102657206" style="zoom:50%;" />
   
   复杂网络环境中的NIPS部署：
   
   <img src="/Users/hyperzsb/Library/Application Support/typora-user-images/image-20210510102725791.png" alt="image-20210510102725791" style="zoom:50%;" />

<img src="/Users/hyperzsb/Library/Application Support/typora-user-images/image-20210510102745759.png" alt="image-20210510102745759" style="zoom:50%;" />

独立部署的多路NIPS部署：

<img src="/Users/hyperzsb/Library/Application Support/typora-user-images/image-20210510102814683.png" alt="image-20210510102814683" style="zoom:50%;" />

分布式NIPS部署：

<img src="/Users/hyperzsb/Library/Application Support/typora-user-images/image-20210510102845053.png" alt="image-20210510102845053" style="zoom:50%;" />